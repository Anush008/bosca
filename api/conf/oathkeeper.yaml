serve:
  proxy:
    port: 4455
  api:
    port: 4456

access_rules:
  repositories:
    - file://conf/accounts/access-rules.yaml
    - file://conf/content/access-rules.yaml

mutators:
  header:
    enabled: true
    config:
      headers:
        X-Subject: "{{ print .Subject }}"
  noop:
    enabled: true
  id_token:
    enabled: true
    config:
      issuer_url: https://auth.bosca.io/
      jwks_url: https://auth.bosca.io/.well-known/jwks.json

authorizers:
  allow:
    enabled: true
  deny:
    enabled: true
  keto_engine_acp_ory:
    enabled: true
    config:
      base_url: https://permissions.bosca.io
      subject: "{{ .MatchContext.Header.Get \"X-Subject\" }}"
      required_action: "{{ .MatchContext.Header.Get \"X-ResourceType\" }}:{{ .MatchContext.Header.Get \"X-Action\" }}"
      required_resource: "{{ .MatchContext.Header.Get \"X-ResourceType\" }}:{{ .MatchContext.Header.Get \"X-ResourceId\" }}"

authenticators:
  noop:
    enabled: true
  bearer_token:
    enabled: true
    config:
      check_session_url: https://accounts.bosca.io/sessions/whoami
      preserve_path: true
      subject_from: "identity.id"
      token_from:
        header: Authorization
  anonymous:
    enabled: true
    config:
      subject: anonymous
  oauth2_client_credentials:
    enabled: true
    config:
      token_url: https://bosca.io/oauth2/token